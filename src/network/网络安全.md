æœ¬ç¯‡å¸¦ä½ å­¦ä¹ ç½‘ç»œå®‰å…¨å†…å®¹ï¼Œå…ˆè®¤è¯†å®‰å…¨å¨èƒï¼Œå†ä»‹ç»ç½‘ç»œå®‰å…¨åŸºç¡€ï¼ŒåŒ…æ‹¬å¯†ç æŠ€æœ¯ã€å®‰å…¨åè®®ã€è®¿é—®æ§åˆ¶ä¸‰éƒ¨åˆ†ï¼Œæœ€åä»‹ç»å¸¸è§çš„Webæ”»å‡»ä¸é˜²èŒƒæªæ–½ã€‚

## å®‰å…¨å¨èƒ
- è¢«åŠ¨æ”»å‡»ï¼šåˆå«æˆªè·ã€æµé‡åˆ†æã€‚çªƒå¬ç½‘ç»œä¸Šçš„å†…å®¹ï¼Œä¸å¹²æ‰°ä¿¡æ¯æµ
- ä¸»åŠ¨æ”»å‡»ï¼šå¹²æ‰°ä¿¡æ¯æµæˆ–ç ´åç¨‹åºã€‚å¸¸è§æ‰‹æ®µæœ‰ç¯¡æ”¹ã€æ¶æ„ç¨‹åºï¼ˆè®¡ç®—æœºç—…æ¯’(ä¿®æ”¹ç›®æ ‡ç¨‹åº)ã€è®¡ç®—æœºè •è™«(é€šè¿‡ç½‘ç»œä¼ æ’­æ‰§è¡Œ)ã€ç‰¹æ´›å› æœ¨é©¬(æ‰§è¡Œéæ‰€å£°ç§°çš„ç¨‹åº)ã€é€»è¾‘ç‚¸å¼¹(ç¨‹åºæ¼æ´)ï¼‰ã€æ‹’ç»æœåŠ¡

## å¯†ç æŠ€æœ¯
è‹¥ä¸€ä¸ªå¯†ç ä½“åˆ¶ä¸­çš„å¯†ç ä¸èƒ½åœ¨ä¸€å®šæ—¶é—´å†…è¢«å¯ä»¥ä½¿ç”¨çš„è®¡ç®—èµ„æºç ´è¯‘ï¼Œåˆ™è¿™ä¸€å¯†ç ä½“åˆ¶ç§°ä¸ºåœ¨è®¡ç®—ä¸Šæ˜¯å®‰å…¨çš„ã€‚æˆ‘ä»¬å¯»æ±‚çš„æ˜¯è®¡ç®—ä¸Šæ˜¯å®‰å…¨çš„å¯†ç ä½“åˆ¶ï¼Œè€Œä¸æ˜¯æ— æ¡ä»¶å®‰å…¨çš„å¯†ç ä½“åˆ¶
> å¯†ç å­¦åŒ…æ‹¬å¯†ç ç¼–ç å­¦(å¯†ç ä½“åˆ¶çš„è®¾è®¡å­¦)ã€å¯†ç åˆ†æå­¦(ä»å¯†æ–‡æ¨æ¼”å‡ºæ˜æ–‡æˆ–å¯†é’¥çš„æŠ€æœ¯)ã€å¯†ç ç®¡ç†(åŒ…æ‹¬å¯†é’¥çš„äº§ç”Ÿã€åˆ†é…ã€æ³¨å…¥ã€éªŒè¯å’Œä½¿ç”¨)

### å¯¹ç§°å¯†é’¥å¯†ç ä½“åˆ¶
- ç‰¹ç‚¹
  - åŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥æ˜¯ç›¸åŒçš„ï¼Œä¸¤è€…æ—¢å¯ä»¥æ‹¿æ¥åŠ å¯†ï¼Œä¹Ÿå¯ä»¥æ‹¿æ¥è§£å¯†
  - ç®—æ³•æ˜¯å…¬å¼€çš„ï¼Œå¯†é’¥åˆ™æ˜¯ä¿å¯†çš„
  - åŠ ã€è§£å¯†å¿«

- ç¤ºä¾‹ï¼šSM4ã€DESã€IDEAã€AES

### å…¬é’¥å¯†ç ä½“åˆ¶
- ç‰¹ç‚¹
  - åŠ å¯†å¯†é’¥(å…¬é’¥)å’Œè§£å¯†å¯†é’¥(ç§é’¥)æ˜¯ä¸åŒçš„ï¼Œç§é’¥åªèƒ½è§£å¯†ï¼Œå…¬é’¥åªèƒ½åŠ å¯†
  - åŠ å¯†å¯†é’¥ã€ç®—æ³•æ˜¯å…¬å¼€çš„ï¼Œè§£å¯†å¯†é’¥æ˜¯ä¿å¯†çš„
  - åŠ ã€è§£å¯†æ…¢

- ç¤ºä¾‹ï¼šDeffieã€Iellmanã€Nerkleã€RSAã€èƒŒåŒ…å…¬é’¥ä½“åˆ¶ã€SM2

- åº”ç”¨ï¼šæ•°å­—ç­¾å
  
  ç‰¹ç‚¹ï¼š
  - æŠ¥æ–‡é‰´åˆ«(é˜²å†’å……)
  - æŠ¥æ–‡çš„å®Œæ•´æ€§(é˜²ç¯¡æ”¹)
  - ä¸å¯å¦è®¤(é˜²æŠµèµ–)

  è¿‡ç¨‹ï¼š
  - å¯¹æŠ¥æ–‡è¿›è¡Œæ‘˜è¦è¿ç®—ï¼Œç”Ÿæˆæ‘˜è¦
  - ä½¿ç”¨ç§é’¥åŠ å¯†æ‘˜è¦ï¼Œç”ŸæˆæŠ¥æ–‡é‰´åˆ«ç 
  - å°†æŠ¥æ–‡é‰´åˆ«ç æ‹¼æ¥åœ¨æŠ¥æ–‡å
  - å¯¹æŠ¥æ–‡è¿›è¡Œæ‘˜è¦è¿ç®—ï¼Œå¯¹æŠ¥æ–‡é‰´åˆ«ç ä½¿ç”¨å…¬é’¥è§£å¯†ï¼Œå¯¹è¿™ä¸¤ä»½ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œè‹¥ç›¸åŒåˆ™ä¼ è¾“è¿‡ç¨‹ä¸­ä¸é­é‡ç¯¡æ”¹

  > ç†è§£é‰´åˆ«
    - å®šä¹‰ï¼šç”¨äºéªŒè¯é€šä¿¡å¯¹æ–¹çš„ç¡®æ˜¯è‡ªå·±æ‰€è¦é€šä¿¡çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯å…¶ä»–å†’å……è€…
    - é‰´åˆ«æ–¹å¼åˆ†ç±»
      - æŠ¥æ–‡é‰´åˆ«ï¼šæ¯æ¬¡æ”¶åˆ°æŠ¥æ–‡æ—¶éªŒè¯ã€‚ä½¿ç”¨æŠ¥æ–‡æ‘˜è¦ï¼Œå¦‚MD5ã€å®‰å…¨æ•£åˆ—ç®—æ³•SHAã€SM3
      - å®ä½“é‰´åˆ«ï¼šç¬¬ä¸€æ¬¡æ”¶åˆ°æŠ¥æ–‡æ—¶éªŒè¯ã€‚ä½¿ç”¨å¯¹ç§°å¯†é’¥åŠ å¯†èº«ä»½å’Œå£ä»¤ä¼ è¾“ï¼Œä½†ä¸ºäº†é¿å…é‡æ”¾æ”»å‡»ï¼Œä½¿ç”¨éå¯¹ç§°åŠ å¯†ä¸é‡æ•°(ä¸é‡å¤ä½¿ç”¨çš„å¤§éšæœºæ•°ï¼Œä¸€æ¬¡ä¸€æ•°)ä¼ è¾“ï¼Œä½†é˜²ä¸äº†ä¸­é—´äººæ”»å‡»ï¼Œé€šè¿‡å…¬é’¥åˆ†é…å¯è§£å†³

  > MD5æ‘˜è¦(å“ˆå¸Œå€¼/æ•°å­—æŒ‡çº¹)
    - ç‰¹ç‚¹ï¼šä¸åŒè¾“å…¥ä¸åŒè¾“å‡ºï¼›è¿‡ç¨‹ä¸å¯é€†ï¼›å®‰å…¨æ€§é«˜ï¼›
    - *åŸç†ï¼š
      
      å¡«å……ï¼šå…ˆä½¿ä¿¡æ¯çš„å­—èŠ‚é•¿åº¦æ»¡è¶³N * 64 + 56ï¼ˆå­—èŠ‚ï¼‰ï¼Œå³N * 512 + 448ï¼ˆä½ï¼‰ï¼ŒNä¸ºæ­£æ•´æ•°ï¼Œå¡«å……æ–¹å¼æ˜¯åœ¨ä¿¡æ¯åé¢åŠ è¡¥ä¸€ä¸ª1å’Œæœ‰é™ä¸ª0ï¼Œç›´è‡³æ»¡è¶³ä¸Šè¿°æ¡ä»¶ã€‚æœ€ååœ¨åé¢è¡¥å……è¡¨ç¤ºå¡«å……å‰ä¿¡æ¯çš„64ä½äºŒè¿›åˆ¶é•¿åº¦ã€‚æ­¤æ—¶ä¿¡æ¯å­—èŠ‚é•¿åº¦ä¸º512çš„æ•´æ•°å€

      N * 512ä½åˆ†ç»„ ->  N * 16ä¸ª * 32ä½å­åˆ†ç»„ -> 4 * 32ä½å­åˆ†ç»„ ->  128ä½æ•£åˆ—å€¼å®ç°
      - å–ç¬¬ä¸€ä¸ªåˆ†ç»„ä½œä¸ºé“¾æ¥å˜é‡ï¼Œå†å°†4ä¸ªé“¾æ¥å˜é‡çš„æ•´æ•°å‚æ•°ï¼ˆå³0x1234567ï¼Œ0x89abcdefï¼Œ0xfedcba98ï¼Œ0x76543210ï¼‰åˆ†åˆ«èµ‹å€¼ç»™å˜é‡A/aï¼ŒB/bï¼ŒC/cï¼ŒD/dï¼Œè¿›è¡Œ4è½®å¾ªç¯è¿ç®—ï¼Œæ¯è½®å¾ªç¯çš„æ¬¡æ•°æ˜¯N
      - æ¯æ¬¡å…ˆä»aï¼Œbï¼Œcï¼Œdä»»å–3ä¸ªä½œéçº¿æ€§å‡½æ•°è¿ç®—ï¼Œæ¥ç€å°†æ‰€å¾—ç»“æœåŠ ä¸Šç¬¬4ä¸ªå˜é‡ï¼Œå†è®©ç»“æœå‘å³ç¯ç§»ä¸€ä¸ªä¸å®šçš„æ•°ï¼Œæœ€ååŠ ä¸Šaï¼Œbï¼Œcï¼Œdä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œå¹¶ç”¨è¯¥ç»“æœå–ä»£aï¼Œbï¼Œcï¼Œdä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œä¾æ­¤ç±»æ¨ï¼Œå¾ªç¯Næ¬¡
      - å››è½®ç»“æŸåï¼Œè®©Aï¼ŒBï¼ŒCï¼ŒDåŠ ä¸Šå››è½®ç»“æŸåå¯¹åº”çš„aï¼Œbï¼Œcï¼Œd
      - å–ä¸‹ä¸€åˆ†ç»„ï¼Œé‡å¤ä»¥ä¸Šæ­¥éª¤ï¼Œä¾æ­¤ç±»æ¨ï¼Œæœ€åæ‰€æœ‰åˆ†ç»„æ‰§è¡Œå®Œåï¼Œè¾“å‡ºçš„æ˜¯Aï¼ŒBï¼ŒCï¼ŒDçš„çº§è”ï¼Œè€Œç»“æœä¸ºDCBAç»„æˆçš„128ä½ç»“æœ
    
    - æ”¹è¿›ï¼šå¯¹å¯†æ–‡æˆªå–ä¸€æ®µæ•°æ®å¹¶ä¸¢å¼ƒï¼Œå†ç”¨éšæœºæ•°å¡«å……ã€‚å³ä½¿é€šè¿‡XSSå’ŒCSRFè·å–å¯†æ–‡ï¼Œåœ¨å·¥ç¨‹ä»£ç è¢«çªƒå–å‰æ˜¯æ— è§£çš„

    - åº”ç”¨ï¼šæ•°å­—ç­¾åã€æ–‡ä»¶å®Œæ•´æ€§éªŒè¯ã€æä¾›ç¬¬ä¸‰æ–¹æœåŠ¡çš„å£ä»¤åŠ å¯†

### å¯†é’¥åˆ†é…
- å¯¹ç§°å¯†é’¥åˆ†é…
    
  å¯†é’¥åˆ†é…ä¸­å¿ƒKDCï¼šè´Ÿè´£ç»™éœ€è¦ç§˜å¯†é€šä¿¡çš„ç”¨æˆ·ä¸´æ—¶åˆ†é…ä¸€ä¸ªä¼šè¯å¯†é’¥ã€‚å¯†é’¥åˆ†é…æµç¨‹å¦‚ä¸‹ï¼Œ
  ``` 
   A         KDC        B
       -> (A, B)
       <- Ka(Kab, Kb(A, B, Kab))
                  -> Kb(A, B, Kab)
  ```
  Kaæ˜¯Açš„ä¸»å¯†é’¥ï¼ŒKbæ˜¯Bçš„ä¸»å¯†é’¥ï¼ŒKabæ˜¯Aå’ŒBä¹‹é—´çš„ä¸€æ¬¡ä¼šè¯å¯†é’¥
    
  Kerberosï¼šæ—¢æ˜¯ä¸€ä¸ªå¯†é’¥åˆ†é…åè®®ï¼Œåˆæ˜¯ä¸€ä¸ªKDC
  ```
  A         é‰´åˆ«æœåŠ¡å™¨AS      ç¥¨æ®æˆäºˆæœåŠ¡å™¨TGS       B
      -> A
      <- Ka(Ks, Ktg(A, Ks))
                        -> (Ks(T), B, Ktg(A, Ks))
      <- (Ks(B, Kab), Kb(A, Kab))
                                            -> (Kab(T), Kb(A, Kab))
      <- Kab(T+1)                                      
  ```
  Kaæ˜¯Açš„å¯¹ç§°å¯†é’¥ï¼ŒKsæ˜¯Aä¸TGSé€šä¿¡çš„ä¼šè¯å¯†é’¥ï¼ŒKtgæ˜¯TGSçš„å¯¹ç§°å¯†é’¥ï¼ŒTæ˜¯æ—¶é—´æˆ³ï¼ŒKabæ˜¯Aå’ŒBé€šä¿¡çš„ä¼šè¯å¯†é’¥ï¼ŒKbæ˜¯Bçš„å¯†é’¥

- å…¬é’¥åˆ†é…

  è®¤è¯ä¸­å¿ƒCAï¼šå°†å…¬é’¥ä¸å…¶å¯¹åº”å®ä½“(äººæˆ–å®ä½“)è¿›è¡Œç»‘å®šï¼Œä¸€èˆ¬ç”±æ”¿åºœæˆ–å¤§å…¬å¸æä¾›
  
  X.509åè®®æ ‡å‡†ï¼šæè¿°è¯ä¹¦ç»“æ„ï¼Œæ—¨åœ¨ç»Ÿä¸€CAæ ¼å¼ã€‚IETFåŸºäºæ­¤æ ‡å‡†ç»™å‡ºX.509å…¬é’¥åŸºç¡€ç»“æ„PKI

  æ•°å­—è¯ä¹¦ï¼šåŒ…å«é¢å‘è¯ä¹¦æœºæ„ã€æ•°å­—ç­¾åä½¿ç”¨çš„æŠ¥æ–‡æ‘˜è¦ç®—æ³•ã€è¯ä¹¦æŒæœ‰è€…çš„éå¯¹ç§°å…¬é’¥ã€æŠ¥æ–‡é‰´åˆ«ç MAC(åç”Ÿæˆé™„åŠ )ç­‰ä¿¡æ¯ã€‚å…¶å·¥ä½œæœºåˆ¶å¦‚ä¸‹ï¼Œ
    - å‘é€å‰ï¼Œå¯¹è¯ä¹¦åŸæ–‡å…ˆè¿›è¡ŒæŠ¥æ–‡æ‘˜è¦è¿ç®—ï¼Œå†ç”¨CAçš„ç§é’¥ç­¾åæ‘˜è¦ï¼Œç”ŸæˆæŠ¥æ–‡é‰´åˆ«ç ï¼ŒåŠ åˆ°è¯ä¹¦æœ€å
    - æ”¶åˆ°åï¼Œå¯¹è¯ä¹¦åŸæ–‡è¿›è¡ŒæŠ¥æ–‡æ‘˜è¦è¿ç®—ï¼Œå¯¹æŠ¥æ–‡é‰´åˆ«ç æ ¸å®ç­¾åï¼Œå¯¹æ¯”å‰åä¸¤ä»½æ‘˜è¦æ˜¯å¦ä¸€è‡´ã€‚åšåˆ°è¿™ä¸€æ­¥å·²ç»é˜²ç¯¡æ”¹ã€ä¸å¯å¦è®¤
    - å„å¤§æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿå·²å†…ç½®æ‰€æœ‰æƒå¨è¯ä¹¦æœºæ„çš„æ ¹è¯ä¹¦ã€‚æœ‰äº†è¿™ä¸€æ­¥å¯ä»¥é˜²çªƒå–ï¼Œé˜²æ­¢ä¸­é—´äººæ”»å‡»ï¼Œä¹Ÿå®ç°äº†çœŸæ­£çš„é˜²å†’å……

## å®‰å…¨åè®®
- ç½‘ç»œå±‚å®‰å…¨åè®®IPSecåè®®

  åŠŸèƒ½ï¼šæä¾›æºç‚¹é‰´åˆ«ã€æ•°æ®å®Œæ•´æ€§å’Œä¿å¯†

  æ„ä»¶
  - å®‰å…¨å…³è”SAï¼šé€šä¿¡å‰é¡»åˆ›å»ºçš„ä¸€æ¡ç½‘ç»œå±‚çš„é€»è¾‘é“¾æ¥ã€‚æ˜¯ä»æºç‚¹åˆ°ç»ˆç‚¹çš„å•å‘è¿æ¥ï¼Œæºç‚¹éœ€ç»´æŠ¤å®‰å…¨å‚æ•°ç´¢å¼•SPIã€SAæºç‚¹å’Œç»ˆç‚¹ã€åŠ å¯†ç®—æ³•ã€åŠ å¯†å¯†é’¥ã€å®Œæ•´æ€§æ£€æŸ¥çš„ç±»å‹ã€é‰´åˆ«ä½¿ç”¨çš„å¯†é’¥ç­‰çŠ¶æ€ä¿¡æ¯
  - å®‰å…¨å…³è”æ•°æ®åº“SADï¼šå‘é€æˆ–æ¥æ”¶IPsecæŠ¥æ—¶ï¼Œåœ¨åº“ä¸­æŸ¥æ‰¾SAè·å¾—ä¿¡æ¯ï¼Œå®æ–½å®‰å…¨ä¿æŠ¤ï¼Œæˆ–æ£€æŸ¥è¯¥åˆ†ç»„çš„å®‰å…¨æ€§
  - å®‰å…¨ç­–ç•¥æ•°æ®åº“SPDï¼šæ¥æ”¶IPsecæŠ¥æ—¶ï¼ŒæŒ‡å‡ºæ˜¯å¦ä½¿ç”¨IPsec
  - å› ç‰¹ç½‘å¯†é’¥äº¤æ¢IKEåè®®ï¼šä¸€ä¸ªå¤æ‚çš„åè®®

  ä¸¤ç§å·¥ä½œæ–¹å¼
  - è¿è¾“æ–¹å¼ï¼šåœ¨è¿è¾“å±‚æŠ¥æ–‡æ®µå‰é¢æ·»åŠ IPSecé¦–éƒ¨å’ŒESPé¦–éƒ¨çš„æ§åˆ¶å­—ç¬¦ï¼Œåé¢æ·»åŠ ESPå°¾éƒ¨å’ŒESP MACçš„æ§åˆ¶å­—æ®µï¼Œæ„æˆIPSecæ•°æ®æŠ¥ï¼ŒåŠ å¯†èŒƒå›´æ˜¯è¿è¾“å±‚æŠ¥æ–‡æ®µå¼€å§‹åˆ°ESPå°¾éƒ¨
  - éš§é“æ–¹å¼ï¼šåœ¨ç½‘ç»œå±‚æ•°æ®æŠ¥å‰é¢æ·»åŠ IPSecé¦–éƒ¨å’ŒESPé¦–éƒ¨çš„æ§åˆ¶å­—ç¬¦ï¼Œåé¢æ·»åŠ ESPå°¾éƒ¨å’ŒESP MACçš„æ§åˆ¶å­—æ®µï¼Œæ„æˆIPSecæ•°æ®æŠ¥ï¼ŒåŠ å¯†èŒƒå›´æ˜¯ç½‘ç»œå±‚æ•°æ®æŠ¥å¼€å§‹åˆ°ESPå°¾éƒ¨ã€‚å¸¸ç”¨è¯¥æ–¹å¼å®ç°è™šæ‹Ÿä¸“ç”¨ç½‘VPN

- è¿è¾“å±‚å®‰å…¨åè®®SSL/TLS

  å«ä¹‰&å…³ç³»ï¼šSSLè¡¨ç¤ºå®‰å…¨å¥—æ¥å­—å±‚ï¼ŒTLSè¡¨ç¤ºè¿è¾“å±‚å®‰å…¨ï¼ŒTLSæ˜¯åœ¨SSL3.0åŸºç¡€ä¸Šè®¾è®¡å‡ºæ¥

  æä¾›çš„å®‰å…¨æœåŠ¡ï¼šæœåŠ¡å™¨é‰´åˆ«(å…è®¸ç”¨æˆ·è¯å®æœåŠ¡å™¨èº«ä»½)ã€å®¢æˆ·ç«¯é‰´åˆ«(å…è®¸æœåŠ¡å™¨è¯å®å®¢æˆ·èº«ä»½)ã€åŠ å¯†çš„SSLä¼šè¯

  SSLå·¥ä½œè¿‡ç¨‹ï¼šåå•†ä½¿ç”¨çš„å¯¹ç§°åŠ å¯†ç®—æ³•-> æœåŠ¡å™¨é‰´åˆ«(æœåŠ¡å™¨ä¸‹å‘è¯ä¹¦ï¼Œå®¢æˆ·ç«¯éªŒè¯) -> ä¼šè¯å¯†é’¥è®¡ç®—(å®¢æˆ·ç«¯äº§ç”Ÿéšæœºæ•°ï¼Œå¹¶ç”¨å…¬é’¥åŠ å¯†å‘ç»™æœåŠ¡å™¨ï¼›æœåŠ¡å™¨ç”¨ç§é’¥è§£å¯†ï¼Œè·å¾—å¯¹ç§°å¯†é’¥) -> å®‰å…¨æ•°æ®ä¼ è¾“(å®¢æœä¸¤ç«¯é€šè¿‡å¯¹ç§°å¯†é’¥è¿›è¡ŒåŠ å¯†é€šä¿¡)

- åº”ç”¨å±‚ç”µå­é‚®ä»¶å®‰å…¨åè®®PGP

  ç”±äºç”µå­é‚®ä»¶æ²¡æœ‰ä¼šè¯è€Œäº§ç”Ÿçš„é—®é¢˜
  - å¦‚ä½•ç¡®å®šåŠ å¯†ç®—æ³•ï¼Ÿå°†è¦ä½¿ç”¨çš„ç®—æ³•åç§°åŒ…å«åœ¨ç”µå­é‚®ä»¶ä¸­ï¼ˆç”µå­é‚®ä»¶å®‰å…¨åè®®éœ€è¦ä¸ºå„ç§åŠ å¯†æ“ä½œå®šä¹‰ç›¸åº”çš„ç®—æ³•ï¼‰
  - å¦‚ä½•çŸ¥æ™“å¯†é’¥ï¼ŸéšæŠ¥æ–‡ä¸€èµ·å‘é€ï¼Œä½†ä¼šè¢«åŠ å¯†ï¼ˆç”µå­é‚®ä»¶å®‰å…¨åè®®è¦æ±‚ä½¿ç”¨å¯¹ç§°å¯†é’¥ç®—æ³•ï¼‰
  - å¦‚ä½•ç¡®è®¤åŒæ–¹çš„å…¬é’¥ï¼Ÿç¬¬ä¸‰æ–¹ç­¾ç½²(è‹¥ç”¨æˆ·Aã€Båˆ†åˆ«å’Œç¬¬ä¸‰æ–¹Cå·²äº’ç›¸ç¡®è®¤å¯¹æ–¹æ‹¥æœ‰çš„å…¬é’¥å±å®ï¼Œåˆ™Cå¯ä»¥ç”¨å…¶ç§é’¥åˆ†åˆ«å¯¹Aã€Bçš„å…¬é’¥è¿›è¡Œç­¾åï¼Œä¸ºè¿™ä¸¤ä¸ªå…¬é’¥åšæ‹…ä¿ã€‚å½“Aå¾—åˆ°ä¸€ä¸ªç»Cç­¾åçš„Bçš„å…¬é’¥æ—¶ï¼Œå¯ä»¥ç”¨å·²ç¡®è®¤çš„Cçš„å…¬é’¥å¯¹Bçš„å…¬é’¥è¿›è¡Œé‰´åˆ«)ï¼Œç±»ä¼¼CAç­¾å‘çš„è¯ä¹¦

  å·¥ä½œåŸç†
  - å‘é€æ–¹ï¼šåˆ†3æ­¥ï¼ŒR1 = X + åŠ å¯†(æ•£åˆ—(X), Açš„ç§é’¥)ï¼ŒR2 = åŠ å¯†(R1, ä¸€æ¬¡æ€§å¯†é’¥)ï¼ŒR3 = R2 + åŠ å¯†(ä¸€æ¬¡æ€§å¯†é’¥, Bçš„å…¬é’¥)
  - æ¥æ”¶æ–¹ï¼šåˆ†3æ­¥ï¼Œä¸€æ¬¡æ€§å¯†é’¥ = è§£å¯†(R3 - R2, Bçš„ç§é’¥)ï¼ŒR1 = è§£å¯†(R2, ä¸€æ¬¡æ€§å¯†é’¥)ï¼Œè§£å¯†((R1 - X), Açš„å…¬é’¥) === æ•£åˆ—(X)

## è®¿é—®æ§åˆ¶
- åˆç§°ä¸ºå­˜å–æ§åˆ¶ã€æ¥å…¥æ§åˆ¶
- ç›®çš„ï¼šä¿è¯ç½‘ç»œèµ„æºä¸è¢«éæ³•ä½¿ç”¨å’Œè®¿é—®
- æ‰‹æ®µï¼šå…¥ç½‘è®¿é—®æ§åˆ¶ã€ç½‘ç»œæƒé™æ§åˆ¶ã€ç›®å½•çº§å®‰å…¨æ§åˆ¶ã€å±æ€§å®‰å…¨æ§åˆ¶

### ç³»ç»Ÿå®‰å…¨ï¼šé˜²ç«å¢™ä¸å…¥ä¾µæ£€æµ‹
- é˜²ç«å¢™

  é€šè¿‡ä¸¥æ ¼æ§åˆ¶è¿›å‡ºç½‘ç»œè¾¹ç•Œçš„åˆ†ç»„ï¼Œç¦æ­¢ä»»ä½•ä¸å¿…è¦çš„é€šä¿¡ï¼Œå‡å°‘æ½œåœ¨å…¥ä¾µçš„å‘ç”Ÿ

  åˆ†ç±»
  - ç½‘ç»œçº§é˜²ç«å¢™ï¼šé˜²æ­¢æ•´ä¸ªç½‘ç»œå‡ºç°å¤–æ¥éæ³•å…¥ä¾µï¼Œå¦‚åˆ†ç»„è¿‡æ»¤è·¯ç”±å™¨(æ ¹æ®è¿‡æ»¤è§„åˆ™å¯¹åˆ†ç»„æ‰§è¡Œè½¬å‘æˆ–ä¸¢å¼ƒï¼Œæ”¯æŒæ— çŠ¶æ€å’Œæœ‰çŠ¶æ€çš„åˆ†ç»„ã€‚ç®€å•é«˜æ•ˆï¼Œå¯¹ç”¨æˆ·é€æ˜)ã€æˆæƒæœåŠ¡å™¨
  - åº”ç”¨çº§é˜²ç«å¢™ï¼Œç”¨äºè®¿é—®æ§åˆ¶ï¼Œå¦‚åº”ç”¨ç½‘å…³(ç›¸å½“äºæŠ¥æ–‡ä¸­ç»§ï¼Œå®ç°åŸºäºåº”ç”¨å±‚æ•°æ®çš„è¿‡æ»¤å’Œé«˜å±‚ç”¨æˆ·é‰´åˆ«)
  - æ•°æ®åº“é˜²ç«å¢™

  > é˜²ç«å¢™å¤–çš„ç½‘ç»œç§°ä¸ºä¸å¯ä¿¡ç½‘ç»œï¼Œé˜²ç«å¢™å†…çš„ç½‘ç»œç§°ä¸ºå¯ä¿¡ç½‘ç»œ

- å…¥ä¾µæ£€æµ‹ç³»ç»ŸIDS

  é€šè¿‡å¯¹è¿›å…¥ç½‘ç»œçš„åˆ†ç»„è¿›è¡Œæ·±åº¦åˆ†æä¸æ£€æµ‹å‘ç°ç–‘ä¼¼å…¥ä¾µè¡Œä¸ºçš„ç½‘ç»œæ´»åŠ¨(ç½‘ç»œæ˜ å°„ã€ç«¯å£æ‰«æã€Dosæ”»å‡»ã€è •è™«ã€ç—…æ¯’ã€ç³»ç»Ÿæ¼æ´æ”»å‡»)ï¼Œå¹¶è¿›è¡ŒæŠ¥è­¦ä»¥ä¾¿è¿›ä¸€æ­¥é‡‡å–ç›¸åº”æªæ–½

  æ£€æµ‹æ–¹æ³•
  - åŸºäºç‰¹å¾çš„å…¥ä¾µæ£€æµ‹ï¼šç»´æŠ¤ä¸€ä¸ªæ‰€æœ‰å·²çŸ¥æ”»å‡»æ ‡å¿—æ€§ç‰¹å¾çš„æ•°æ®åº“ï¼Œå¯¹æœªçŸ¥æ”»å‡»åˆ™æŸæ‰‹æ— ç­–
  - åŸºäºå¼‚å¸¸çš„å…¥ä¾µæ£€æµ‹ï¼šè§‚å¯Ÿæ­£å¸¸è¿è¡Œçš„ç½‘ç»œæµé‡ï¼Œå­¦ä¹ æ­£å¸¸æµé‡çš„ç»Ÿè®¡ç‰¹æ€§å’Œè§„å¾‹ï¼Œå½“æ£€æµ‹åˆ°ç½‘ç»œä¸­æµé‡æŸç§ç»Ÿè®¡è§„å¾‹ä¸ç¬¦åˆæ­£å¸¸æƒ…å†µæ—¶ï¼Œåˆ™è®¤ä¸ºå¯èƒ½å‘ç”Ÿäº†å…¥ä¾µè¡Œä¸º

  æ¼æŠ¥ç‡å’Œè¯¯æŠ¥ç‡ä¹‹é—´åšå¹³è¡¡

## Webå®‰å…¨
- https://developer.mozilla.org/zh-CN/docs/Web/Security

### Webæ”»å‡»åˆ†ç±»
1ã€å¯¹è¾“å‡ºæœªåšä»»ä½•å¤„ç†å¼•å‘çš„å®‰å…¨æ¼æ´
- SQLæ³¨å…¥
- XSS
- ç›®å½•éå†
- HTTPé¦–éƒ¨æ³¨å…¥
- é‚®ä»¶é¦–éƒ¨æ³¨å…¥
- OSå‘½ä»¤æ³¨å…¥
- è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´

2ã€ä¼šè¯ç®¡ç†ç–å¿½å¼•å‘çš„å®‰å…¨æ¼æ´
- CSRF
- ä¼šè¯åŠ«æŒ
- ä¼šè¯å›ºå®šæ”»å‡»

3ã€è®¾è®¡ç¼ºé™·å¼•å‘çš„å®‰å…¨æ¼æ´
- å¼ºåˆ¶æµè§ˆ
- ä¸æ­£ç¡®çš„é”™è¯¯æ¶ˆæ¯å¤„ç†
- å¼€æ”¾é‡å®šå‘

4ã€å…¶ä»–å®‰å…¨æ¼æ´
- Dos
- ä¸­é—´äººæ”»å‡»
- å¯†ç ç ´è§£
- ç‚¹å‡»åŠ«æŒ
- åé—¨ç¨‹åº

### å¸¸è§Webæ”»å‡»ä¸é˜²èŒƒ
#### SQLæ³¨å…¥
- å¸¸è§æ‰‹æ®µï¼šååŠ `or 1=1`ã€`union select 1,database()`(ä¸€æ­¥æ­¥æŸ¥å‡ºåº“åã€è¡¨åã€åˆ—å) 
- é˜²èŒƒï¼š
  
  å‚æ•°åŒ–æŸ¥è¯¢
  ```java
  String sql = "select id from users where name=?";
  PreparedStatement state = conn.prepareStatement(sql);
  state.setString(1, request.getParameter("name"));
  state.executeQuery();
  ```

  å¯†ç ä»¥åŠ ç›å“ˆå¸Œçš„æ–¹å¼å­˜å‚¨åœ¨æ•°æ®åº“
  ```javascript
  // åŠ ç›èƒ½æœ‰æ•ˆé¢„é˜²å½©è™¹è¡¨æ”»å‡»ï¼Œç›ä¸èƒ½å–å¾—å¤ªå¸¸è§„
  hash(`${password}${salt}`)
  ```

#### è·¨ç«™æ”»å‡»è„šæœ¬XSS
- å«ä¹‰ï¼šä¸€ç§æ³¨å…¥å¼æ”»å‡»ï¼Œæºäºå¯¹éé¢„æœŸè¾“å…¥çš„ä¿¡ä»»ï¼Œåˆ©ç”¨è¾“å…¥çš„ä¸ä¸¥è°¨æ€§æ’å…¥æ¶æ„JSä»£ç ï¼Œå¦‚ç›—å·(ä¼šè¯åŠ«æŒ)ã€çªƒå–æ•°æ®(ä¿¡æ¯æ³„éœ²)ã€æŒ‚é©¬ã€æœ‰æ•ˆè½½è·ã€PoC(éªŒè¯ç¨‹åºæ˜¯å¦æœ‰æ¼æ´ï¼Œæ— å®³)ã€Exp(åˆ©ç”¨ç¨‹åºæ˜¯å¦æœ‰æ¼æ´ï¼Œæœ‰å®³)

- åŸç†ï¼šæ„é€ æ”»å‡»ä»£ç ï¼Œç»ç”±æœªåšå¤„ç†çš„æœåŠ¡ç«¯ï¼Œæœ€åæµè§ˆå™¨è§£ææ‰§è¡Œæ”»å‡»è„šæœ¬

- åˆ†ç±»

  åå°„å‹XSSï¼šè¯±å¯¼ç”¨æˆ·ç‚¹å‡»æ”»å‡»è€…æä¾›çš„æ³¨å…¥æ¶æ„è„šæœ¬çš„urlï¼ŒæœåŠ¡å™¨æœªå¯¹å†…å®¹ä½œå¤„ç†å¯¼è‡´æµè§ˆå™¨æ‰§è¡Œï¼Œå¦‚

  `attacked_url?content=%3Cscript src=attack_url/attack.js%3E%3C/script%3E`

  å­˜å‚¨å‹XSSï¼šæ”»å‡»è€…é€šè¿‡å¯ç¼–è¾‘å…ƒç´ æäº¤æ¶æ„ä»£ç åˆ°æœåŠ¡å™¨ï¼Œç”¨æˆ·ä¸€è®¿é—®ç›¸åº”ç½‘é¡µä¾¿æ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¦‚
  
  - Samyè •è™«ï¼šå†å²ä¸Šç¬¬ä¸€ä¸ªå­˜å‚¨å‹XSSã€‚é€šè¿‡å…è®¸çš„`style`å±æ€§å’Œä»…IEæ”¯æŒçš„CSSå‡½æ•°`express`é…åˆå®ç°è‡ªåŠ¨æ·»åŠ å¥½å‹ã€ä¿®æ”¹ç®€ä»‹

  - å›¾ç‰‡æ³¨å…¥æ¶æ„ä»£ç ï¼šcat normal.jpg b.js > attack.jpg

    è°ƒç”¨ç”»å¸ƒ`drawImage`æ–¹æ³•é‡æ–°ç”Ÿå›¾ï¼Œå¯ä»¥å°†å›¾ç‰‡ä¸­çš„è„šæœ¬è¿‡æ»¤
    
    > æŸ¥çœ‹å›¾ç‰‡å†…å®¹æ–¹å¼ï¼šé€šè¿‡`FileReader.readerAsText`è¯»å–å›¾ç‰‡èµ„æºï¼Œæˆ–æ›´ç®€å•åœ°ï¼Œæ‰“å¼€æ§åˆ¶å°ï¼Œé€‰æ‹©å›¾ç‰‡å…ƒç´ ï¼Œå³é”®é€‰æ‹©Reveal in Sources panel

  > åå°„å‹XSSéœ€å€ŸåŠ©å„ç§ç¤¾äº¤æ¸ é“ä¼ æ’­æ”»å‡»çš„URLæ¥å®æ–½ï¼Œè€Œå­˜å‚¨å‹XSSé€šè¿‡ç½‘ç«™æ¼æ´è¿›è¡Œæ”»å‡»ï¼Œæˆæœ¬ä½ä¸”æ€å®³åŠ›æ›´å¤§

- é˜²èŒƒ

  1ã€[æœåŠ¡ç«¯å¯¹æŸ¥è¯¢åšç¼–ç ](https://github.com/ESAPI/esapi-java-legacy)ï¼Œé˜²æ­¢æµè§ˆå™¨è§£æï¼Œå¦åˆ™åªèƒ½åœ¨æµè§ˆå™¨åšç¼–ç æˆ–è½¬ä¹‰
  
  2ã€æµè§ˆå™¨ä½¿ç”¨ç™½åå•è¿‡æ»¤ï¼Œè€Œä¸ç›´æ¥å¯¹scriptæ ‡ç­¾ã€styleå±æ€§ç­‰è¿›è¡Œé»‘åå•è¿‡æ»¤çš„æ–¹å¼ï¼Œå­˜åœ¨é£é™©
  ![](/network/safety/XSSé»‘åå•è¿‡æ»¤é£é™©.png)
  
  3ã€*ä¸ºcookieè®¾ç½®`httpOnly`ï¼Œç¦ç”¨jsè®¿é—®cookie

> *XSSç›²æ‰“ï¼šæ”»å‡»è€…å¯¹æ•°æ®æäº¤åå±•ç°åå°æœªçŸ¥æƒ…å†µçš„ä¸€ç§XSSæ”»å‡»æ–¹å¼ï¼Œ[XSSç›²æ‰“å¹³å°](http://xsstest.com)ä¸ºè¿™ç§æ–¹å¼æä¾›åŸºæœ¬åŠŸèƒ½

#### è·¨åŸŸè¯·æ±‚ä¼ªé€ CSRF
- å«ä¹‰ï¼šåŠ«æŒå®¢æˆ·ç«¯è¯·æ±‚ä¸­çš„ä¼šè¯å‡­è¯ï¼Œåˆ©ç”¨è¯¥å‡­è¯å†’å……ç”¨æˆ·åšéæ³•æ“ä½œã€‚é€šè¿‡éšè—è¡¨å•ã€ç½‘ç»œæ‹¦æˆªã€å­˜å‚¨å‹XSSå¦‚é€šè¿‡`a`ã€`img`ã€`iframe`æ ‡ç­¾ã€CSSä¼ªå…ƒç´ ã€`background-image:url()`ã€è‡ªå®šä¹‰å­—ä½“ç­‰æ–¹å¼åŠ«æŒä¼šè¯

- ç¤ºä¾‹

  æ”»å‡»è€…æäº¤äº†è®¿é—®æ”»å‡»ç½‘ç«™çš„å›¾ç‰‡ï¼Œå¹¶æ³¨å…¥`?c=${document.cookie}`

- é˜²èŒƒ

  1ã€*ä¸ºcookieè®¾ç½®`samesite:lax`ï¼Œé˜»æ­¢è·¨åŸŸè¯·æ±‚æºå¸¦

  2ã€*è®¾ç½®CSPï¼Œé™åˆ¶CSSã€JSæ¥æº
    - [å†…å®¹å®‰å…¨ç­–ç•¥CSP](https://content-security-policy.com/)ï¼šé€šè¿‡è®¾ç½®[`Content-Security-Policy`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy)å’Œ[`Content-Security-Policy-Report-Only`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy-Report-Only)å“åº”å¤´ï¼Œå‘Šè¯‰æµè§ˆå™¨å¯åŠ è½½å“ªäº›èµ„æºã€‚å¯ä»¥é˜²æ­¢XSSå’ŒCSRF 
    
    - ç¤ºä¾‹ï¼šåªå…è®¸ä½¿ç”¨httpsåŠ è½½èµ„æº
    
      `Content-Security-Policy: default-src https:`

      `<meta http-equiv="Content-Security-Policy" content="default-src https:">`

    - æ³¨ï¼šå­˜åœ¨å¤šä¸ªç›¸åŒçš„CSPï¼Œåˆ™æŒ‰æœ€ä¸¥æ ¼çš„ç­–ç•¥æ‰§è¡Œï¼›CSPæ— æ³•ç®¡ç†worker

  3ã€ä½¿ç”¨ä»¤ç‰Œæ›¿ä»£cookie

  4ã€ä½¿ç”¨HTTPSåè®®

  5ã€é€šè¿‡referè¯·æ±‚å¤´æ£€æŸ¥è¯·æ±‚æº

  6ã€*åœ¨æ‰€æœ‰æ›´æ”¹çŠ¶æ€çš„è¯·æ±‚ä¸Šç¦ç”¨CORSï¼Œé˜²æ­¢ç¬¬ä¸‰æ–¹è¡¨å•æäº¤åˆ°ç«¯ç‚¹

  7ã€éªŒè¯ç ï¼šåŒ…æ‹¬å›¾å½¢éªŒè¯ç ã€çŸ­ä¿¡éªŒè¯ã€æ‹¼å›¾ã€è¯†å›¾é€‰æ‹©ã€æ•°å­¦è®¡ç®—ã€‚åŒºåˆ†ç”¨æˆ·æ˜¯è®¡ç®—æœºè¿˜æ˜¯äººçš„å…¬å…±å…¨è‡ªåŠ¨ç¨‹åºï¼Œé˜²æ­¢æ¶æ„ç ´è§£å¯†ç ã€åˆ·ç¥¨ã€è®ºå›çŒæ°´
  ```py
  fail_count = get_from_redis(fail_username)

  # å¯†ç é”™è¯¯æ¬¡æ•° <= 3ï¼Œå›¾å½¢éªŒè¯
  if fail_count <= 3:
    if captcha is None:
      return error('éœ€è¦éªŒè¯ç ')
    if check_captcha(captcha)
      return error('éªŒè¯ç é”™è¯¯')

  # å¯†ç é”™è¯¯æ¬¡æ•° > 3ï¼ŒçŸ­ä¿¡éªŒè¯
  if fail_count > 3:
    if dynamic_code is None:
      return error('éœ€è¦çŸ­ä¿¡éªŒè¯ç ')
    if not validate_dynamic_code(username, dynamic_code):
      delete_dynamic_code(username)
      return error('çŸ­ä¿¡éªŒè¯ç é”™è¯¯')

  success = do_login(username, password)

  if not success:
    set_redis(fail_username, fail_count + 1)
  ```

#### ä¸­é—´äººæ”»å‡»
- å·¥ä½œåŸç†
  
  ![](/network/safety/ä¸­é—´äººæ”»å‡».jpg)
  
- é˜²èŒƒ

  ä½¿ç”¨HTTPSåè®®ï¼Œå…·æœ‰å†…å®¹åŠ å¯†ã€èº«ä»½éªŒè¯ã€æ•°æ®å®Œæ•´æ€§ä¿æŠ¤ç‰¹ç‚¹

> sslstripæ˜¯ä¸€æ¬¾ç”±Moxie Marlinspikeå¼€å‘çš„ä¸­é—´äººæ”»å‡»(MITM)å·¥å…·ï¼Œä¸»è¦ç›®çš„æ˜¯å°†ç›®æ ‡ç½‘ç»œä¸­çš„HTTPSæµé‡é™çº§ä¸ºHTTPæµé‡ï¼Œçªƒå–ç”¨æˆ·ä¿¡æ¯ã€‚å…¶å·¥ä½œåŸç†æ˜¯æ‹¦æˆªå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ï¼ŒæŠŠæœåŠ¡å™¨è¿”å›çš„HTTPSé“¾æ¥æ›¿æ¢æˆHTTPé“¾æ¥ï¼Œè®©å®¢æˆ·ç«¯çœ‹èµ·æ¥ä»åœ¨å’Œ"å®‰å…¨ç«™ç‚¹"é€šä¿¡ï¼Œç»•è¿‡SSL/TLSåŠ å¯†ä¿æŠ¤
>   
> HSTS(HTTP Strict Transport Securityï¼ŒHTTPä¸¥æ ¼ä¼ è¾“å®‰å…¨)æ˜¯ä¸€ç§å®‰å…¨ç­–ç•¥æœºåˆ¶ï¼Œç”¨äºå¼ºåˆ¶å®¢æˆ·ç«¯ä»…é€šè¿‡HTTPSåè®®ä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œæœç»HTTPSé™çº§æ”»å‡»ã€‚å…·ä½“æ“ä½œæ˜¯æœåŠ¡å™¨é€šè¿‡å“åº”å¤´Strict-Transport-Securityå‘æµè§ˆå™¨å‘é€æŒ‡ä»¤ï¼Œæµè§ˆå™¨æ”¶åˆ°åä¼šåœ¨æŒ‡å®šæ—¶é—´å†…è‡ªåŠ¨å°†æ‰€æœ‰å¯¹è¯¥åŸŸåçš„HTTPè¯·æ±‚è½¬ä¸ºHTTPSè¯·æ±‚ï¼Œä¸”ä¸ä¼šæ¥å—ç”¨æˆ·æ‰‹åŠ¨è·³è¿‡çš„å®‰å…¨è­¦å‘Šï¼Œå½»åº•é˜»æ–­sslstripè¿™ç±»é™çº§æ”»å‡»çš„å¯èƒ½

#### æ‹’ç»æœåŠ¡DoS
- å·¥ä½œåŸç†ï¼šå‘é€æµ·é‡æ•°æ®åŒ…ï¼Œé¡·åˆ»**å æ»¡ç›®æ ‡ç³»ç»Ÿçš„å…¨éƒ¨å¸¦å®½**ï¼Œæ­£å¸¸è¯·æ±‚è¢«å µåœ¨é—¨å¤–ï¼Œæ‹’ç»æœåŠ¡ç›®çš„è¾¾æˆã€‚è‹¥æ”»å‡»æ¥è‡ªå››é¢å…«æ–¹ï¼Œåˆ™ç§°ä¸ºåˆ†å¸ƒå¼æ‹’ç»æœåŠ¡DDosï¼Œä¹Ÿå«åšç½‘ç»œå¸¦å®½æ”»å‡»æˆ–è¿é€šæ€§æ”»å‡»
- ç¤ºä¾‹

  - ICMP Flood
    
    åŸç†ï¼šICMPæŒ‡Internetæ§åˆ¶æŠ¥æ–‡åè®®ï¼Œç”¨äºåœ¨IPä¸»æœºã€è·¯ç”±å™¨ä¹‹é—´ä¼ é€’**æ§åˆ¶æ¶ˆæ¯**ï¼Œæ§åˆ¶æ¶ˆæ¯æ˜¯æŒ‡ç½‘ç»œé€šä¸é€šã€ä¸»æœºæ˜¯å¦å¯è¾¾ã€è·¯ç”±æ˜¯å¦å¯ç”¨ç­‰ç½‘ç»œæœ¬èº«çš„æ¶ˆæ¯
    
    ä¸¾ä¾‹ï¼šUDP Floodï¼Œå‘é€å¤§é‡ä¼ªé€ æºIPåœ°å€çš„å°UDPåŒ…

    ç‰¹ç‚¹ï¼šä¼ ç»Ÿæµé‡æ”»å‡»æŠ€æœ¯é‡è¾ƒä½ï¼Œæ”»å‡»æ•ˆæœå¸¸ä¾èµ–å—æ§ä¸»æœºæœ¬èº«çš„ç½‘ç»œæ€§èƒ½ï¼Œæ˜“è¢«æŸ¥åˆ°æ”»å‡»æºå¤´
  
  - NTP Flood

    åŸç†ï¼šæ”»å‡»è€…ä½¿ç”¨**ç‰¹æ®Šçš„æ•°æ®åŒ…ï¼Œå³ç›®çš„IPåœ°å€æŒ‡å‘ä½œä¸ºåå°„å™¨çš„æœåŠ¡å™¨ï¼ŒæºIPåœ°å€ä¼ªé€ ä¸ºæ”»å‡»ç›®æ ‡IP**ã€‚åå°„å™¨æ¥æ”¶åˆ°æ•°æ®åŒ…æ—¶è¢«éª—ï¼Œä¼šå°†å“åº”æ•°æ®å‘é€ç»™è¢«æ”»å‡»ç›®æ ‡ï¼Œè€—å°½è¢«æ”»ç½‘ç»œçš„å¸¦å®½èµ„æºã€‚æ›´å¹¿æ³›è®²ï¼Œåˆ©ç”¨å„ç§åè®®çš„è¡Œä¸ºç‰¹æ€§ã€ç³»ç»Ÿçš„ç¼ºé™·ã€æœåŠ¡çš„è„†å¼±æ€§ã€è½¯ä»¶çš„æ¼æ´ç­‰ç­‰å‘èµ·æ”»å‡»ï¼Œä¸æ–­å ç”¨ç›®æ ‡ç³»ç»Ÿçš„èµ„æºä»¥é˜»æ­¢å®ƒä»¬å¤„ç†æ­£å¸¸äº‹åŠ¡å’Œè¯·æ±‚

    ![](/network/safety/DoSåå°„æ”¾å¤§æ”»å‡»åŸç†.jpg)
    
    ä¸¾ä¾‹ï¼šé—®ç­”å¼çš„åè®®éƒ½å¯ä»¥è¢«åˆ©ç”¨ï¼Œæ¯”å¦‚NTPï¼Œå®ƒæ˜¯æ ‡å‡†çš„åŸºäºUDPåè®®ä¼ è¾“çš„ç½‘ç»œæ—¶é—´åŒæ­¥åè®®

    ç‰¹ç‚¹ï¼šåå°„æ”¾å¤§æ”»å‡»å ªç§°ä¸€ç§"å€Ÿåˆ€æ€äºº"çš„æµé‡å‹æ”»å‡»
  
  - SYN Flood

    åŸç†ï¼šåˆ©ç”¨**TCPåè®®ç¼ºé™·**(TCPç¬¬ä¸‰æ¬¡æ¡æ‰‹æ— æ³•å®Œæˆï¼ŒæœåŠ¡å™¨ç«¯ä¸€èˆ¬ä¼šé‡è¯•å¹¶ç­‰å¾…ä¸€æ®µæ—¶é—´åå†ä¸¢å¼ƒè¿™ä¸ªæœªå®Œæˆçš„è¿æ¥)ï¼Œå‘é€å¤§é‡ä¼ªé€ çš„TCPè¿æ¥è¯·æ±‚ï¼Œä½¿è¢«æ”»å‡»æ–¹èµ„æºè€—å°½ï¼ˆCPUæ»¡è´Ÿè·æˆ–å†…å­˜ä¸è¶³ï¼‰çš„æ”»å‡»æ–¹å¼

    ä¸¾ä¾‹ï¼šCCæ”»å‡»ã€‚å¦‚HTTP Floodæ¨¡æ‹Ÿå¤šä¸ªæ­£å¸¸ç”¨æˆ·ä¸åœè®¿é—®å¦‚è®ºå›è¿™äº›éœ€è¦å¤§é‡æ•°æ®æ“ä½œçš„é¡µé¢ï¼Œé€ æˆæœåŠ¡å™¨èµ„æºçš„æµªè´¹ï¼ŒCPUé•¿æ—¶é—´å¤„äº100%(æ•°æ®åº“å‹åŠ›è¶Šå¤§ï¼Œè¢«è®¿é—®çš„é¢‘ç‡è¶Šé«˜ï¼Œå ç”¨çš„ç³»ç»Ÿèµ„æºè¶Šå¤š)ï¼Œæ°¸è¿œéƒ½æœ‰å¤„ç†ä¸å®Œçš„è¯·æ±‚ï¼Œç½‘ç»œæ‹¥å¡ï¼Œæ­£å¸¸è®¿é—®è¢«ä¸­æ­¢ï¼›å†è€…DNS Query Floodï¼Œéšæœºç”Ÿæˆæˆ–è€…æ˜¯ç½‘ç»œä¸Šæ ¹æœ¬ä¸å­˜åœ¨çš„åŸŸåï¼Œç”±äºåœ¨æœ¬åœ°æ— æ³•æŸ¥åˆ°å¯¹åº”çš„ç»“æœï¼ŒæœåŠ¡å™¨å¿…é¡»ä½¿ç”¨é€’å½’æŸ¥è¯¢å‘ä¸Šå±‚åŸŸåæœåŠ¡å™¨æäº¤è§£æè¯·æ±‚ï¼Œå¼•èµ·è¿é”ååº”

    ç‰¹ç‚¹ï¼šæˆæœ¬ä½ã€å¨åŠ›å¤§ã€æŠ€æœ¯å«é‡é«˜(é’ˆå¯¹WebæœåŠ¡åœ¨ç¬¬ä¸ƒå±‚åè®®å‘èµ·çš„æ”»å‡»ï¼Œåœ¨è¶Šä¸Šå±‚åè®®ä¸Šå‘åŠ¨DDoSæ”»å‡»è¶Šéš¾ä»¥é˜²å¾¡ï¼Œä¸Šå±‚åè®®ä¸ä¸šåŠ¡å…³è”æ„ˆåŠ ç´§å¯†ï¼Œé˜²å¾¡ç³»ç»Ÿé¢ä¸´çš„æƒ…å†µä¹Ÿä¼šæ›´å¤æ‚)ï¼Œè§ä¸åˆ°çœŸå®æºIPï¼Œè§ä¸åˆ°ç‰¹åˆ«å¤§çš„å¼‚å¸¸æµé‡ï¼Œä½†æœåŠ¡å™¨å°±æ˜¯æ— æ³•è¿›è¡Œæ­£å¸¸è¿æ¥

#### HTTPè¯·æ±‚èµ°ç§
- å·¥ä½œåŸç†
  
  åˆ©ç”¨HTTPä»£ç†é“¾è·¯ä¸Šçš„HTTP Serverå®ç°å­˜åœ¨ä¸ä¸€è‡´æ¼æ´è¿›è¡Œæ”»å‡»ã€‚ä¸ä¸å…¶ä»–webæ”»å‡»ä¸€æ ·ç›´è§‚ï¼Œè€Œæ˜¯åœ¨å¤æ‚çš„ç½‘ç»œç¯å¢ƒä¸­ï¼Œå› ä¸åŒæœåŠ¡å™¨åŸºäºä¸åŒçš„RFCæ ‡å‡†å®ç°çš„é’ˆå¯¹HTTPåè®®åŒ…çš„ä¸åŒå¤„ç†æ–¹å¼è€Œäº§ç”Ÿçš„ä¸€ç§å®‰å…¨é£é™©ï¼Œå…·ä½“å¦‚ä¸‹ï¼Œ

  ![](/network/safety/HTTPèµ°ç§.png)

  å½“ä¸åŒæœåŠ¡å™¨å®ç°æ—¶å‚è€ƒçš„RFCæ ‡å‡†ä¸åŒæ—¶ï¼Œå‘reverse proxyå‘é€ä¸€ä¸ªæ¨¡ç³Šçš„HTTPè¯·æ±‚ï¼Œå¯èƒ½äº§ç”Ÿreverse proxyè®¤ä¸ºè¯¥HTTPè¯·æ±‚åˆæ³•ï¼Œå¹¶è½¬å‘åˆ°back-endï¼Œè€Œback-endåªè®¤ä¸ºéƒ¨åˆ†HTTPè¯·æ±‚åˆæ³•ï¼Œå‰©ä¸‹çš„å¤šä½™è¯·æ±‚å±äº"èµ°ç§"çš„HTTPè¯·æ±‚äº†ï¼Œå¯¹ç”¨æˆ·é€ æˆå½±å“ï¼Œå°±å®ç°HTTPèµ°ç§æ”»å‡»

- ç¤ºä¾‹
  
  - getè¯·æ±‚ä½¿ç”¨bodyå‘é€æ•°æ®ï¼Œè®¾ç½®Content-Lengthï¼ˆè§„èŒƒæ¯”è¾ƒæ¨¡ç³Šï¼Œåªæåˆ°æºå¸¦payloadçš„getè¯·æ±‚æ²¡æœ‰å®šä¹‰ï¼Œå¯èƒ½è¢«æ‹’ç»ï¼‰
    ```
    # ç”±äºæ˜¯getè¯·æ±‚ï¼ŒæœåŠ¡å™¨ä¸å¯¹Content-Lengthå¤„ç†ï¼ŒåŒæ—¶å› ä¸ºpipelineå­˜åœ¨ï¼Œåç«¯æœåŠ¡å™¨ä¼šå°†è¯¥æ•°æ®åŒ…è§†ä¸ºä¸¤ä¸ªgetè¯·æ±‚
    GETÂ /Â HTTP/1.1
    Host:Â example.com
    Content-Length:Â 44

    GETÂ /secretÂ HTTP/1.1
    Host:Â example.com
    
    # ç»“æœ
    # è¯·æ±‚1
    GETÂ /Â HTTP/1.1
    Host:Â example.com
    
    # è¯·æ±‚2
    GETÂ /secretÂ HTTP/1.1
    Host:Â example.com
    ```
    
  - åŒæ—¶è®¾ç½®Content-Lengthå’ŒTransfer-Encodingï¼Œä½†ä»£ç†æœåŠ¡å™¨å¤„ç†Content-Lengthï¼Œåç«¯æœåŠ¡å™¨(éµå®ˆRFC2616è§„å®š)å¤„ç†Transfer-Encodingï¼Œåˆæˆ–ä»£ç†æœåŠ¡å™¨å¤„ç†Transfer-Encodingï¼Œåç«¯æœåŠ¡å™¨å¤„ç†Content-Length

    ä¼ªé€ èµ°ç§è¯·æ±‚æ§åˆ¶è¯·æ±‚urlã€è¯·æ±‚å†…å®¹ï¼Œè¿›è¡Œåˆ é™¤ç”¨æˆ·ã€åå°„XSSã€è·³è½¬åˆ°é’“é±¼ç½‘ç«™ç­‰æ”»å‡»

    ![](/network/safety/ä¼ªé€ èµ°ç§è¯·æ±‚1.png)

    ![](/network/safety/ä¼ªé€ èµ°ç§è¯·æ±‚2.png)
  
  - è®¾ç½®ä¸¤ä¸ªä¸åŒå€¼çš„Transfer-Encodingè¯·æ±‚å¤´ï¼Œå¯¹Transfer-Encodingè¿›è¡ŒæŸç§æ··æ·†æ“ä½œ(æ¯”å¦‚ç»™Content-Lengthè®¾ç½®é”™è¯¯çš„å€¼)ï¼Œä½¿å…¶ä¸­ä¸€ä¸ªæœåŠ¡å™¨ä¸å¤„ç†Transfer-Encodingè¯·æ±‚å¤´

  - è®¾ç½®ä¸¤ä¸ªä¸åŒå€¼çš„Content-Lengthè¯·æ±‚å¤´ï¼ˆè§„å®šå½“æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ä¸­åŒ…å«ä¸¤ä¸ªContent-Lengthï¼Œä¸”ä¸¤è€…å€¼ä¸åŒæ—¶ï¼Œéœ€è¦è¿”å›400é”™è¯¯ï¼‰
    ```
    # å½“æœåŠ¡å™¨æœªéµå¾ªè¯¥è§„èŒƒï¼Œå‰ã€åæœåŠ¡å™¨éƒ½ä¸ä¼šå“åº”400ï¼Œå¯èƒ½é€ æˆä»£ç†æœåŠ¡å™¨ä½¿ç”¨ç¬¬ä¸€ä¸ªContent-Lengthè·å–é•¿åº¦ï¼Œè€Œåç«¯æŒ‰ç…§ç¬¬äºŒä¸ªContent-Lengthè·å–é•¿åº¦
    POSTÂ /Â HTTP/1.1
    Host:Â example.com
    Content-Length:Â 8
    Content-Length:Â 7
    12345\r\n
    a

    # ä»£ç†æœåŠ¡å™¨ä¼šä¸åç«¯æœåŠ¡å™¨é‡ç”¨TCPé€šé“ï¼Œè¿™ä¸ªæ—¶å€™aå°±ä¼šæ‹¼æ¥åˆ°ä¸‹ä¸€ä¸ªè¯·æ±‚
    aGETÂ /Â HTTP/1.1\r\n
    Host:Â example.com\r\n
    ```

- é˜²èŒƒ
  - ç¦ç”¨ä»£ç†æœåŠ¡å™¨ä¸åç«¯æœåŠ¡å™¨ä¹‹é—´çš„TCPè¿æ¥é‡ç”¨ï¼ˆå–æ¶ˆTCPé‡ç”¨å°†å¢å¤§æœåŠ¡å™¨è´Ÿè½½ï¼ŒæœåŠ¡å™¨èµ„æºåƒä¸æ¶ˆï¼‰
  - ä½¿ç”¨HTTP/2åè®®ï¼ˆHTTP/2æ¨è¡Œè¿‡äºå›°éš¾ï¼Œå°½ç®¡HTTP/2å…¼å®¹HTTP/1.1ï¼‰
  - å‰åç«¯ä½¿ç”¨ç›¸åŒçš„æœåŠ¡å™¨ï¼ˆä½¿ç”¨ç›¸åŒçš„æœåŠ¡å™¨ï¼Œä¸€äº›å‚å•†å¾ˆéš¾å®ç°ï¼Œä¸»è¦åŸå› æ˜¯å‰åç«¯å®ç°æ ‡å‡†ä¸ä¸€è‡´çš„é—®é¢˜ï¼‰
  - ä¸Šäº‘ï¼ˆç»Ÿä¸€å®ç°ç¼–ç è§„èŒƒï¼Œå¯ä»¥å¾ˆå¥½åœ°é¿å…è¯¥ç±»é—®é¢˜çš„äº§ç”Ÿï¼‰

#### æ—¶åºæ”»å‡»
```javascript
import express from "express";

const authApi = express.Router();

authApi.post("/session", async (req, res) => {  
  const params: { 
    email: string; 
    password: string 
  } = req.body;    
  
  if (!req.headers["x-csrf-token"] || req.headers["x-csrf-token"] !== req.Cookie["xCsrfToken"]) {  
    return res.status(400).json({ message: "Invalid CSRF token." });  
  }    
  
  // å½“å¤§é‡è¯·æ±‚è½°å‡»æœåŠ¡å¹¶è®¡æ—¶æ—¶ï¼Œå¯¹äºä¸å­˜åœ¨çš„ç”¨æˆ·å“åº”æ›´å¿«
  const user = Users.findByEmail(params.email);
  if (!user || !Users.verifyPassword(params.password, user)) { 
    // ä¸ºæ— æ•ˆå‡­è¯çš„è¯·æ±‚ï¼Œæ·»åŠ éšæœºå»¶è¿Ÿï¼Œç¼“è§£æ—¶åºæ”»å‡»
    await new Promise((resolve) => setTimeout(resolve, crypto.randomInt(11, 111))); 
    return res.status(401).json({ message: "Invalid credentials." });  
  }    
  
  const sessionId = generateToken();    
  res.Cookie("sessionId", sessionId, { 
    httpOnly: true, 
    maxAge: 1000 * 3600 * 24, 
    sameSite: "lax" 
  });  
  Sessions.add({ 
    sessionId, 
    userEmail: user.email 
  });    
  
  const response: ApiSessionRes = { 
    email: user.email, 
    name: user.name 
  };  
  
  res.status(200).json(response);  
});    

authApi.delete("/session", async (req, res) => {  
  if (req.Cookie["sessionId"]) 
    Sessions.remove(req.Cookie["sessionId"]);    
  res.clearCookie("sessionId");    
  res.status(200).json({ message: "Signed out." });  
});    

export { 
  authApi 
};
```


### å®‰å…¨æªæ–½
- é€šè¿‡helmetè®¾ç½®å“åº”å¤´ï¼Œå¦‚ç¦ç”¨x-powered-by(é˜²æš´éœ²åº”ç”¨ç¨‹åºå¼•æ“)ï¼Œç¦ç”¨mimeç±»å‹å—…æ¢ï¼Œå¯åŠ¨HSTS(ä¼˜å…ˆhttps)
  ```javascript
  import express from "express";  
  import fs from "fs";  
  import helmet from "helmet";  
  import https from "https";  
  import path from "path";

  const app = express();

  // é¿å…æ‰‹åŠ¨è°ƒæ•´CSPã€HSTSã€X-Powered-Byã€MIME-sniffingç­‰ï¼›å°½å¯èƒ½è®¾ç½®æœ€ä¸¥æ ¼çš„CSPã€‚  
  app.use(helmet({ 
    contentSecurityPolicy: { 
      directives: { 
        defaultSrc: "'self'" 
      }
    } 
  }));

  app.use(express.json());    

  const client = path.resolve(__dirname, "../build");  
  if (fs.existsSync(client)) 
    app.use(express.static(client));    

  app.get("/healthz", (_, res) => { 
    res.send({ message: "We're live ğŸš€" }); 
  });    

  const httpsOptions = {  
    key: fs.readFileSync(path.join(__dirname, "./tls/cert.key")),  
    cert: fs.readFileSync(path.join(__dirname, "./tls/cert.pem")),  
  };    
  const portHttps = process.env.PORT_HTTPS || 8080;  
  https.createServer(httpsOptions, app).listen(portHttps, async () => {  
    console.log(`HTTPS server listening at ${portHttps}`); // eslint-disable-line no-console  
  });
  ```

- SRI
  - å«ä¹‰ï¼šSub Resource Integrityï¼Œå­èµ„æºå®Œæ•´æ€§ï¼Œä¸€ç§Webé™æ€èµ„æºå®‰å…¨ç­–ç•¥ï¼Œé˜²æ­¢ç½‘ç«™å¼•ç”¨çš„å¤–éƒ¨èµ„æºè¢«ç¯¡æ”¹
  - å·¥ä½œåŸç†ï¼šé€šè¿‡æ·»åŠ integrityå±æ€§ï¼ŒæŒ‡å®šä¸€ä¸ªå“ˆå¸Œå€¼å’Œç›¸åº”çš„å“ˆå¸Œç®—æ³•ã€‚å½“æµè§ˆå™¨åŠ è½½èµ„æºæ—¶ï¼Œä¼šè®¡ç®—è¯¥èµ„æºçš„å“ˆå¸Œå€¼ï¼Œå¹¶å°†å…¶ä¸integrityå±æ€§ä¸­æŒ‡å®šçš„å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœä¸¤è€…ä¸ç›¸ç­‰ï¼Œæµè§ˆå™¨å°†æ‹’ç»åŠ è½½è¯¥èµ„æºï¼Œä»è€Œé˜²æ­¢äº†æ¶æ„èµ„æºçš„åŠ è½½
  - ç¤ºä¾‹
    ```html
    <!-- integrityç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå“ˆå¸Œç®—æ³•ï¼ˆsha384ï¼‰å’Œå¯¹åº”çš„å“ˆå¸Œå€¼ï¼ˆhash-valueï¼‰ -->
    <script src="https://example.com/path/to/script.js"
      integrity="sha384-hash-value"
      crossorigin="anonymous">
    </script>
    ```
  - åº”ç”¨ï¼šå¸¸ç”¨äºCDN

- å±æ€§target='_blank'çš„æ ‡ç­¾aï¼Œå­˜åœ¨å®‰å…¨å’Œæ€§èƒ½éšæ‚£ï¼Œè®¾ç½®noopenerå¯è§£å†³

  å“ªäº›éšæ‚£ï¼Ÿ  
  - å®‰å…¨éšæ‚£ï¼šå¦‚window.opener.locationæŒ‡å‘hackerç½‘ç«™ 
  - æ€§èƒ½éšæ‚£ï¼šæ‰“å¼€çš„é¡µé¢é»˜è®¤ä¸åŸé¡µé¢å…±äº«åŒä¸ªè¿›ç¨‹ï¼Œå½“æ‰“å¼€çš„é¡µé¢æ‰§è¡Œäº†è€—æ—¶æ“ä½œï¼Œä¼šé€ æˆåŸé¡µé¢å¡é¡¿ 

  è§£å†³ï¼šè®¾ç½®noopenerï¼Œå¯ä»¥è§£å†³ä»¥ä¸Šéšæ‚£ 
  - cssï¼š`<a target="_blank" rel="noopener">`ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä½ çš„aæ ‡ç­¾æœ‰target="_blank"ï¼Œç°åœ¨ä¼šé»˜è®¤å¼€å¯ rel="noopener"ï¼Ÿ
  - jsï¼š`window.open('https://www.baidu.com', '_blank', 'noopener')`

  > relå–å€¼ä»‹ç»  
    - noopenerï¼šç”¨äºä¸èƒ½è·å–window.openerå¯¹è±¡ï¼Œä¸å½±å“åŸé¡µé¢æ€§èƒ½
    - noreferrerï¼šç”¨äºä¿æŠ¤æºéšç§å®‰å…¨
    - nofollowï¼šç”¨äºseoæƒé‡åˆ†é…

- å¼‚å¸¸æ“ä½œæˆ–ç™»å½•æé†’ï¼šç”¨æˆ·åœ¨éå¸¸ç™»å½•åœ°ç™»å½•ã€ä¿®æ”¹å¯†ç ã€ç™»å½•å¼‚å¸¸æ—¶ï¼ŒçŸ­ä¿¡æé†’ç”¨æˆ·

- æ‹’ç»å¼±å¯†ç ï¼šæ³¨å†Œæˆ–ä¿®æ”¹å¯†ç æ—¶ï¼Œä¸å…è®¸ç”¨æˆ·è®¾ç½®å¼±å¯†ç 

- é˜²æ­¢ç”¨æˆ·åè¢«éå†ï¼šæ³¨å†Œæ—¶ä¸€èˆ¬ä¼šæ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨æ‰€æœ‰ç”¨æˆ·åè¢«æ³„éœ²çš„é£é™©ï¼ˆéå†æ¥å£ï¼‰ï¼Œéœ€è¦åœ¨äº¤äº’æˆ–é€»è¾‘ä¸Šåšé™åˆ¶

- IPé™åˆ¶ï¼Œé’ˆå¯¹IP
  ```python
  fail_count = get_from_redis(fail_ip)
  locked = get_from_redis(lock_ip)

  if locked:
    return error('ipå·²è¢«é”å®š')

  if fail_count >= 3:
    if captcha is None:
      return error('éœ€è¦éªŒè¯ç ')
    check_captcha(captcha)

  success = do_login(username, password)

  if not success:
    set_redis(fail_ip, fail_count + 1)
    # ç™»å½•å¤±è´¥æ¬¡æ•°å¤§äº10æ¬¡ï¼Œé”å®šip300s
    if fail_count + 1 >= 10:
      set_redis(lock_ip, true, 300)
  ```

- ç™»å½•é™åˆ¶ï¼Œé’ˆå¯¹ç”¨æˆ·å
  ```python
  fail_count = get_from_redis(fail_username)
  locked = get_from_redis(lock_username)

  if locked:
    return error('è´¦å·å·²è¢«é”å®š')

  if fail_count >= 3:
    if captcha is None:
      return error('éœ€è¦éªŒè¯ç ')
    check_captcha(captcha)

  success = do_login(username, password)

  if not success:
    set_redis(fail_username, fail_count + 1)
    # ç™»å½•å¤±è´¥æ¬¡æ•°å¤§äº10æ¬¡ï¼Œé”å®šè´¦å·300s
    if fail_count + 1 >= 10:
      set_redis(lock_username, true, 300)
  ```

- å›¾ç‰‡é˜²ç›—é“¾
  - å›¾ç‰‡é˜²ç›—é“¾æ˜¯æŒ‡é€šè¿‡ä¸€ç³»åˆ—æŠ€æœ¯æ‰‹æ®µï¼Œé˜²æ­¢å…¶ä»–ç½‘ç«™æœªç»æˆæƒç›´æ¥å¼•ç”¨æˆ–é“¾æ¥åˆ°æœ¬ç½‘ç«™çš„å›¾ç‰‡èµ„æºï¼Œä»¥ä¿æŠ¤ç½‘ç«™çš„å›¾ç‰‡ç‰ˆæƒå’Œå‡å°‘å¸¦å®½æ¶ˆè€—
  - é˜²èŒƒ

    1ã€æœåŠ¡å™¨å¯ä»¥é€šè¿‡æ£€æŸ¥refererå­—æ®µåˆ¤æ–­è¯·æ±‚æ˜¯å¦æ¥è‡ªæˆæƒåŸŸå

    2ã€CDNé…ç½®é˜²ç›—é“¾è§„åˆ™ï¼ŒæŒ‡å®šå…è®¸çš„å¼•ç”¨åŸŸå

    3ã€ä½¿ç”¨css backgroundå±æ€§æ›¿ä»£imgæ ‡ç­¾

    4ã€canvasç»˜å›¾

    5ã€å›¾ç‰‡åŠ æ°´å°
    
    6ã€å›¾ç‰‡urlåŠ å¯†ï¼Œè§£å¯†åæ–¹èƒ½è®¿é—®

### *JSåè°ƒè¯•
- å¯ç”¨æ–­ç‚¹ç¦æ­¢ä½¿ç”¨devtools
  ```javascript
  // ä¸€ç›´è§¦å‘æ–­ç‚¹
  setTimeout(() => {
    while(true){ 
      eval('debugger')
    }
  })
  ```

- æ£€æµ‹devtoolsæ‰“å¼€æ—¶å¼¹å‡ºalert
  ```javascript
  const divEl = document.createElement('div')
  const loop = setInterval(() => {
    console.log(divEl)
    console.clear()
  })
  // ä¸€æ‰“å¼€devtoolsï¼Œæ‰“å°divå°±ä¼šå°è¯•è·å–idï¼Œä»è€Œè§¦å‘getter
  Object.defineProperty(divEl, 'id', {
    get: () => {
      clearInterval(loop)
      alert('debugger detected')
    }
  })
  ```

- å‡½æ•°é‡å®šä¹‰
  ```javascript
  // æ¯”å¦‚é‡å†™evalå‡½æ•°
  const origin = eval
  const fake = function(){
    // åè°ƒè¯•é€»è¾‘
  }
  eval = fake
  ```

- æ£€æŸ¥æ—¶å·®
  ```javascript
  // é€šè¿‡è¿è¡Œæ—¶é—´åˆ¤æ–­è„šæœ¬å½“å‰æ˜¯å¦åœ¨è°ƒè¯•
  setInterval(() => {
    const start = performance.now()
    let check
    let diff
    for(check = 0; check < 1000; check++){
      console.log(check)
      console.clear()
    }
    diff = performance.now() - start
    if(diff > 200){
      alert('debugger detected')
    }
  }, 500)
  ```

- ä½¿ç”¨ä»£ç†
  ```javascript
  const handler = {
    apply(target, thisArg, args) {
      console.log('intercepted a call to createElement with args:' + args)
      return target.apply(thisArg, args)
    }
  }
  document.createElement = new Proxy(document.createElement, handler)
  try {
    document.createElement()
  } catch(e) {
    alert('debugger detected')
  }
  ```
